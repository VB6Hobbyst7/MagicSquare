<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>Failed to create COM object EasyXLS.ExcelDocument: Access is denied</title>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	<meta name="robots" content="index,follow" />
    <meta name="description" content="'Fatal error: Uncaught com_exception: Failed to create COM object 'EasyXLS.ExcelDocument': Access is denied' error on EasyXLS Excel Library for PHP" />
    <meta name="keywords" content="easyxls, excel, failed to create COM object access is denied, error" />
    <meta property="og:url" content="http://www.easyxls.com/manual/troubleshooting/failed-to-create-com-object-access-is-denied.html" />
    <link rel="stylesheet" type="text/css" href="../includes/GeneralCSS.css"/>
	<link rel="stylesheet" type="text/css" href="../js_menu/menuBarCSS.css"/>
	
	<script language="JavaScript" src="../js_menu/menu.js" type="text/javascript"></script>
	<script language="JavaScript" src="../js_menu/leftMenu.js" type="text/javascript"></script>
	<script language="JavaScript" src="../includes/topMenu.js" type="text/javascript"></script>
	<script language="javascript" src="../includes/GeneralJs.js" type="text/javascript"></script>
</head>

<body onload="loadTopMenu('../');showMenu('mnuTroubleshooting', 'tdtrgTroubleshooting');changeStyle('PHPruntimeerrors');SetFooter()" onresize="SetFooter()">
	<a name="top"></a>
    <table class="header" width="100%" cellpadding="0" cellspacing="0" border="0" height="70" id="Table1">
        <tr>
            <td id="left" align="left" valign="middle" style="padding-left:10px;width:148px">
                <a href="https://www.easyxls.com" target="_blank"><img src="../images/top_logo.gif" alt="EasyXLS" border="0" width="140" height="43"/></a>
            </td>
            <td style="vertical-align:top;padding-top:14px">
                <span style="font-size:30px;color:#98BBCE">|</span>&nbsp;
                <h1><a href="https://www.easyxls.com/net-excel-library" style="text-decoration:none;color:#08708D" target="_blank">Excel library to import or export data to Excel files in PHP</a></h1>
            </td>
            <td height="100%" width="350" valign="bottom">
                <table align="left" cellpadding="0" cellspacing="0" border="0" id="Table2">
                    <tr valign="bottom">
                        <td valign="bottom">
                            <a id="link1" onclick="changeActive(1, '../');" onmouseover="mouseover(1, '../');" onmouseout="mouseout(1, '../');">
                                <img src="../images/tab1_inactive.gif" id="tab1" hspace="0" width="163" height="19" alt="Programmer's Guide" /></a>
                        </td>
                        <td valign="bottom">
                            <a id="link2" onclick="changeActive(2, '../');" onmouseover="mouseover(2, '../');" onmouseout="mouseout(2, '../');">
                                <img src="../images/tab2_inactive.gif" id="tab2" hspace="0" width="74" height="19" alt="API Documentation" /></a>
                        </td>
                        <td>
                            &nbsp;
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
	<table>	
		<tr> 
		    <td class="leftPanel">	
                <br />
                <script language="JavaScript" type="text/javascript">displayLeftMenu("../", "../html/programmerGuide/"); </script>		   
            </td>
		    <td valign="top" width="100%">
			    <br />
			    <table cellpadding="0" cellspacing="2" width="100%" id="Table3">
			        <tr>
                        <td>
                        </td>
                    </tr>
			        <tr>
				        <!--Title section-->
				        <td width="100%">
					        <h2>Why do I get "Failed to create COM object EasyXLS.ExcelDocument: Access is denied" error in PHP?</h2>
				        </td>
			        </tr>
			        <tr>
				        <!--Description section-->
				        <td align="left" width="100%" style="padding-top:20px">
					        <h3>Concept</h3>
					        <div class="layout">
						        The following error might occur at runtime when using EasyXLS Excel library for PHP: 
						        <br /><br />
                                <i>Fatal error: Uncaught com_exception: Failed to create COM object 'EasyXLS.ExcelDocument': Access is denied.</i>
                                <br /><br /> 
                                at line:
                                <br /><br />
                                <i>$workbook = new COM("EasyXLS.ExcelDocument");</i><br /><br />
                            </div>
					        <h3>
                                Reason: The web application cannot access EasyXLS.dll</h3>
                            <div class="layout">
						        If the web application does not have proper permissions, it cannot access the registered EasyXLS.dll. <br /><br />
					        </div>
					        <h3 id="Possible solution #1">
                                Possible solution #1: Set permissions on EasyXLS.dll</h3>
                            <div class="layout">
						        The most suitable solution is to give permissions on the EasyXLS.dll that was registered as COM+ on the machine.
                                <br /><br />
                                If the registration was through EasyXLS installer, the default location of EasyXLS.dll is <i>"&lt;EasyXLS install 
                                path&gt;\COM+ version\DLL\EasyXLS.dll".</i>
                                <br /><br />
                                If EasyXLS.dll was moved and registered from a different location, then EasyXLS.dll must be searched at that location.
                                <br /><br />
                                Right-click on EasyXLS.dll, choose Properties, Security tab:
					        </div>
					        <img src="../images/troubleshooting/easyxls-security-file-properties.png" width="363" height="509" alt="EasyXLS.dll, File Properties, Security tab" align="middle" />
                            <div class="layout">
                                Check if <i>Everyone</i> user is present. If it is not present, add Everyone user with full control or add the user used by the web application.<br /><br />
                            </div>
                            <h3>
                                Possible solution #2: Set permissions for the web application</h3>
                            <div class="layout">
						        Another option is to increase the permissions for the web application.
                                <br /><br />
                                Open Internet Information Services (IIS) Manager in Control Panel/Administrative Tools. Select Application Pools and the application pool associated with your web application. 
					        </div>
					        <img src="../images/troubleshooting/iis-application-pool.png" width="779" height="492" alt="IIS Application Pools" align="middle" />
					        <div class="layout">
					            Select Advanced Settings and check if <i>Process Model/Identity</i> is set to <i>ApplicattionPoolIdentity</i>. 
					        </div>
					        <img src="../images/troubleshooting/iis-process-model-identity.png" width="385" height="470" alt="IIS Process Model Identity" align="middle" />
					        <div class="layout">
					            If so, change the <i>Identity</i> to <i>LocalSystem</i>:
					        </div>
					        <img src="../images/troubleshooting/iis-application-pool-identity.png" width="437" height="247" alt="IIS Application Pool Identity" align="middle" />
					        <div class="layout">
					           If the application pool is used by multiple web applications, you might consider creating a new application pool only for 
					           the web application that uses EasyXLS.
                               <br /><br />
                               <i>Warning: Switching to LocalSystem is the easiest solution, but this decrease the security on the machine and it is not 
                               recommended for live environments. The best option is to run the web application under a Specific User with lower permissions 
                               and give permissions to that user according to <a href="#Possible solution #1">Possible solution #1</a>.</i><br /><br />
					        </div>
					        <h3>Contact us for any other reasons</h3>
                            <div class="layout">
					            If none of the above, contact us at <a href="mailto:support@easyxls.com?Subject=Failed%20to%20create%20COM%20object.%20Access%20is%20denied">support@easyxls.com</a> with details about your application configuration and the 
					            full error message.
					        </div>
				        </td>
			        </tr>
			        <tr>
                        <td>
                            <div id="div1" class="available">
                                <br />
                                Available for: Professional, Excel Writer, Excel Reader, Express Excel Writer<br />
                                <br />
                            </div>
                        </td>
                    </tr>
			        <tr>
                        <td id="tdFooter">
                            <br />
                            <!--Send to Top section-->
                            <div id="divFooter">
                                <a href="#top" class="text">Top</a>
                                <!--banner section-->
                                <br />
                                <div id="banner" class="banner" align="left">
                                    <table id="Table4" cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td class="banner" align="left">
                                                &nbsp;&nbsp;&copy; EU Outsourcing, 2017. All Rights Reserved.
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div style="height: 5px">
                                </div>
                            </div>
                        </td>
                    </tr>		
		        </table>
		    </td>
		    <td valign="top">
                <div id="divPanel" style="position:relative">
                    <table class="rightPanel1" cellspacing="0" cellpadding="10">
                     <tr>
                         <td style="padding-right:0px;padding-left:0px;vertical-align:bottom">
                           <h5>EasyXLS Excel libraries:</h5>
                         </td>
                         <td style="padding-left:0px;padding-right:3px;" align="right">
                           <img src="../images/dot-net.png" width="47" height="47" alt=".NET" />
                         </td>
                     </tr>
                     <tr>
                        <td colspan="2" style="padding-bottom:0px; padding-top:0px">
                            <h6><a class="h6" href="https://www.easyxls.com/net-excel-library" target="_blank">.NET Excel Library</a></h6>
                        </td>
                     </tr>
                     <tr>
                           <td class="textBlue1" colspan="2">
                             full .NET version to import, export or convert Excel files
                           </td>
                     </tr>
                     <tr>
                           <td colspan="2" style="padding-bottom:0px; padding-top:0px">
                            <h6><a class="h6" href="https://www.easyxls.com/net-excel-writer" target="_blank">.NET Excel Writer</a></h6>
                           </td>
                     </tr>
                     <tr>
                           <td class="textBlue1" colspan="2">
                            .NET version to create and export Excel files
                           </td>
                     </tr>
                     <tr>
                           <td colspan="2" style="padding-bottom:0px; padding-top:0px">
                            <h6><a class="h6" href="https://www.easyxls.com/net-excel-reader" target="_blank">.NET Excel Reader</a></h6>
                           </td>
                     </tr>
                     <tr>
                           <td class="textBlue1" colspan="2">
                            .NET version to read and import Excel files
                           </td>
                     </tr>
                     <tr>
                           <td colspan="2" style="padding-bottom:0px; padding-top:0px">
                            <h6><a class="h6" href="https://www.easyxls.com/net-excel-writer-express" target="_blank">.NET Express Excel Writer</a></h6>
                           </td>
                     </tr>
                     <tr>
                        <td class="textBlue1" colspan="2">
                            limited .NET version to create and export Excel files in predefined formats
                        </td>
                     </tr>
                     <tr>
                        <td colspan="2">
                            <a href="https://www.easyxls.com/trials" target="_blank">
                                <img src="../images/download-trial.png" border="0" width="204" height="76" alt="Download EasyXLS&trade; Excel Library for .NET"/>
                            </a>
                        </td>
                     </tr>
                    </table>
                    <div style="height:1px"></div>
                    <table class="rightPanel2" cellspacing="0" cellpadding="10">
                     <tr>
                        <td colspan="4" style="padding-left:0px;vertical-align:top">
                            <h5>File formats: </h5> 
                        </td>
                     </tr>
                     <tr>
                        <td class="textBlue2" colspan="4">
                           MS Excel 97 <br />MS Excel 2003 <br />MS Excel 2007 <br />MS Excel 2010 <br />MS Excel 2013<br />MS Excel 2016<br />
                        </td>
                     </tr>
                     <tr>
                        <td style="padding:2px;padding-left:10px;width:40px">
                           <img src="../images/xls.png" width="40" height="19" alt="XLS" />
                        </td>
                        <td style="padding:2px;width:43px">
                           <img src="../images/xlsx.png" width="43" height="19" alt="XLSX" />
                        </td>
                        <td style="padding:2px;width:42px">
                           <img src="../images/xlsm.png" width="42" height="19" alt="XLSM" />
                        </td>
                        <td style="padding:2px">
                           <img src="../images/xlsb.png" width="42" height="19" alt="XLSB" />
                        </td>
                     </tr>
                     <tr>
                        <td style="padding:2px;padding-left:10px;padding-bottom:10px">
                            <img src="../images/xml.png" width="40" height="19" alt="XML" />
                        </td>
                        <td style="padding:2px;padding-bottom:10px">
                            <img src="../images/html.png" width="43" height="19" alt="HTML" />
                        </td>
                        <td style="padding:2px;padding-bottom:10px">
                            <img src="../images/csv.png" width="36" height="19" alt="CSV" />
                        </td>
                        <td style="padding:2px;padding-bottom:10px">
                           <img src="../images/txt.png" width="36" height="19" alt="TXT" />
                        </td>
                     </tr>
                     <tr>
                        <td style="height:160px" colspan="4"></td>
                     </tr>
                    </table>
                 </div>
            </td> 
        </tr>
    </table>
    
    <script language="JavaScript" type="text/javascript">
        SetFooter();
        window.onscroll = repositionRightPanel2;
    </script>
    
</body>
</html>
