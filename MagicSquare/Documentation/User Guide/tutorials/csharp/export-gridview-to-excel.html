<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
		<title>Export GridView to Excel in C# | EasyXLS Guide</title>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <meta name="robots" content="index,follow" />
        <meta name="description" content="Source code sample on how to export GridView to Excel file in C#.NET from ASP.NET web pages or windows application by EasyXLS. XLS, XLSX, XLSM, XLSB spreadsheets" />
        <meta name="keywords" content="export, gridview, excel, c#, asp.net, .net, windows application, source code" />
        <link rel="stylesheet" type="text/css" href="../../includes/GeneralCSS.css" />
			
			<script language="JavaScript" src="../../includes/topMenu.js" type="text/javascript"></script>
			<script language="javascript" type="text/javascript">
			function back()
			{
				history.back();
			}
			</script>
		<!-- Generated by TextRush -->
	</head>

<body onload="loadTopMenu('../../');" text="#000000" bgcolor="#ffffff">
		<table style="BACKGROUND: url(../../images/top_gradient1.jpg) repeat-y right top; margin: 0px 0px 0px 0px;border-bottom: medium solid #C8ED89;" width="100%" cellpadding="0" cellspacing="0" border="0" height="70" id="Table1">
				<tr>
					<td id="left" align="left" valign="middle" style="padding-left:10px"><h1 id="logo" class="logo"><a href="http://www.easyxls.com" target="_blank" title=".NET Excel library - export to Excel files">.NET Excel library - export to Excel files</a></h1></td>
				
					<td height="100%" width="350" valign="bottom">
						<table align="left" cellpadding="0" cellspacing="0" border="0" id="Table2">
							<tr valign="bottom">
								<td valign="bottom"><a id="link1" onclick="changeActive(1, '../../');" onmouseover="mouseover(1, '../../');" onmouseout="mouseout(1, '../../');"><img src="../../images/tab1_inactive.gif" id="tab1" hspace="0" width="163" height="19" alt="programmer's guide" /></a></td>
								<td valign="bottom"><a id="link2" onclick="changeActive(2, '../../');" onmouseover="mouseover(2, '../../');" onmouseout="mouseout(2, '../../');"><img src="../../images/tab2_inactive.gif" id="tab2" hspace="0" width="74" height="19" alt="api" /></a></td>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
	</table>
	<table>	
		<tr> 
		  <td valign="top">
			 <br/>
			 <table id="Table3" width="500">
			<tr>
				<td align="right" class="text"><a href="javascript:back();">Back</a></td>
				<td width="50">&nbsp;&nbsp;</td>
				<td align="left" class="text"><a href="../../html/programmerGuide/tutorials/html/csharp/UserDefinedCellsFormat/Tutorial2.htm">Next</a></td>
			</tr>
		</table>
		     <pre style="padding-left:60px">
<code><font color="#008000">/* ----------------------------------------------------------------
* Tutorial 01
* 
* This tutorial shows how to export GridView to Excel file in C#.
* The cells are formatted using a predefined format <a href="#section1">(1)</a> .
* ----------------------------------------------------------------- */
<a href="../excel-documents/Tutorial01.xls" target="_blank" rel="nofollow">Click here to see the Excel file.</a>

</font><font color="#0000ff">using </font>System<font color="#000080">;
</font><font color="#0000ff">using </font>System<font color="#000080">.</font>Data<font color="#000080">;
</font><font color="#0000ff">using </font>EasyXLS<font color="#000080">;

</font><font color="#0000ff">namespace </font>WebApplication
<font color="#000080">{
</font><font color="#0000ff">   public partial class </font>ExportToExcelForm <font color="#000080">:</font>System<font color="#000080">.</font>Web<font color="#000080">.</font>UI<font color="#000080">.</font>Page
<font color="#000080">   {
</font><font color="#0000ff">       protected void </font>Page_Load<font color="#000080">(</font><font color="#0000ff">object </font>sender<font color="#000080">,</font>EventArgs e<font color="#000080">)
</font><font color="#000080">       {
</font><font color="#0000ff">           this</font><font color="#000080">.</font>BindGridView<font color="#000080">();
       }
       
</font><font color="#0000ff">       protected void </font>ExportGridViewToExcel<font color="#000080">(</font><font color="#0000ff">object </font>sender<font color="#000080">,</font>EventArgs e<font color="#000080">)
       {
</font><font color="#008000">         //Create a dataset that keeps the gridview datatable
</font>         DataSet dataSet <font color="#000080">=</font><font color="#0000ff"> new </font>DataSet<font color="#000080">();
</font>         dataSet<font color="#000080">.</font>Tables<font color="#000080">.</font>Add<font color="#000080">((</font>DataTable<font color="#000080">)</font>gridView<font color="#000080">.</font>DataSource<font color="#000080">);

</font><font color="#008000">         //Apply the formatting of the GridView to the exported cells
</font>         ExcelAutoFormat xlsAutoformat <font color="#000080">=</font><font color="#0000ff">new </font>ExcelAutoFormat<font color="#000080">();
</font><font color="#008000">         //Format the cells - GridView header
</font>         ExcelStyle xlsStyleHeader <font color="#000080">=</font><font color="#0000ff">new </font>ExcelStyle<font color="#000080">();
</font>         xlsStyleHeader<font color="#000080">.</font>setBackground<font color="#000080">(</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>BackColor<font color="#000080">);
</font>         xlsStyleHeader<font color="#000080">.</font>setForeground<font color="#000080">(</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>ForeColor<font color="#000080">);
</font><font color="#0000ff">         if </font><font color="#000080">(</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">.</font>Length <font color="#000080">==</font><font color="#800000"> 0</font><font color="#000080">)
</font>             xlsStyleHeader<font color="#000080">.</font>setFont<font color="#000080">(</font><font color="#800000">"Times New Roman"</font><font color="#000080">);
</font><font color="#0000ff">         else 
</font>             xlsStyleHeader<font color="#000080">.</font>setFont<font color="#000080">(</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">);
</font><font color="#0000ff">         if </font><font color="#000080">(</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">.</font>Unit<font color="#000080">.</font>Value<font color="#000080">==</font><font color="#800000"> 0</font><font color="#000080">)
</font>             xlsStyleHeader<font color="#000080">.</font>setFontSize<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
</font><font color="#0000ff">         else 
</font>             xlsStyleHeader<font color="#000080">.</font>setFontSize<font color="#000080">((</font><font color="#0000ff">int </font><font color="#000080">)</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">.</font>Unit<font color="#000080">.</font>Value<font color="#000080">);
</font>         xlsStyleHeader<font color="#000080">.</font>setBold<font color="#000080">(</font>gridView<font color="#000080">.</font>HeaderStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Bold<font color="#000080">);
</font>         xlsAutoformat<font color="#000080">.</font>setHeaderRowStyle<font color="#000080">(</font>xlsStyleHeader<font color="#000080">);
</font><font color="#008000">         //Format the cells - GridView row data
</font>         ExcelStyle xlsStyleRow <font color="#000080">=</font><font color="#0000ff">new </font>ExcelStyle<font color="#000080">();
</font>         xlsStyleRow<font color="#000080">.</font>setBackground<font color="#000080">(</font>gridView<font color="#000080">.</font>RowStyle<font color="#000080">.</font>BackColor<font color="#000080">);
</font><font color="#0000ff">         if </font><font color="#000080">(</font>gridView<font color="#000080">.</font>RowStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">.</font>Length <font color="#000080">==</font><font color="#800000"> 0</font><font color="#000080">)
</font>             xlsStyleRow<font color="#000080">.</font>setFont<font color="#000080">(</font><font color="#800000">"Times New Roman"</font><font color="#000080">);
</font><font color="#0000ff">         else 
</font>             xlsStyleRow<font color="#000080">.</font>setFont<font color="#000080">(</font>gridView<font color="#000080">.</font>RowStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">);
</font><font color="#0000ff">         if </font><font color="#000080">(</font>gridView<font color="#000080">.</font>RowStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">.</font>Unit<font color="#000080">.</font>Value <font color="#000080">==</font><font color="#800000"> 0</font><font color="#000080">)
</font>             xlsStyleRow<font color="#000080">.</font>setFontSize<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
</font><font color="#0000ff">         else 
</font>             xlsStyleRow<font color="#000080">.</font>setFontSize<font color="#000080">((</font><font color="#0000ff">int</font><font color="#000080">)</font>gridView<font color="#000080">.</font>RowStyle<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">.</font>Unit<font color="#000080">.</font>Value<font color="#000080">);
</font>         xlsAutoformat<font color="#000080">.</font>setTableStyle<font color="#000080">(</font>xlsStyleRow<font color="#000080">);

</font><font color="#008000">         //Choose a name for the xls file 
</font><font color="#0000ff">         string </font>fileName <font color="#000080">=</font><font color="#800000">"ExportedGridView.xls"</font><font color="#000080">;
</font>         Response<font color="#000080">.</font>Clear<font color="#000080">();
</font>         Response<font color="#000080">.</font>Buffer <font color="#000080">=</font><font color="#0000ff">true </font><font color="#000080">;
</font>         Response<font color="#000080">.</font>AddHeader<font color="#000080">(</font><font color="#800000">"content-disposition"</font><font color="#000080">, </font><font color="#800000">"attachment;filename="</font><font color="#000080"> + </font> fileName<font color="#000080">);
</font>         Response<font color="#000080">.</font>ContentType <font color="#000080">=</font><font color="#800000">"application/vnd.ms-excel"</font><font color="#000080">;

</font><font color="#008000">         //Export Excel file and prompt the "Open or Save Dialog Box" 
</font>         ExcelDocument xls <font color="#000080">=</font><font color="#0000ff">new </font>ExcelDocument<font color="#000080">();
</font>         xls<font color="#000080">.</font>easy_WriteXLSFile_FromDataSet<font color="#000080">(</font>Response<font color="#000080">.</font>OutputStream<font color="#000080">, </font>dataSet<font color="#000080">, </font>xlsAutoformat<font color="#000080">, </font><font color="#800000">"GridView"</font><font color="#000080">);

</font><font color="#008000">         //Dispose memory
</font>         xls<font color="#000080">.</font>Dispose<font color="#000080">();
</font>         Response<font color="#000080">.</font>End<font color="#000080">();
</font><font color="#000080">       }
</font><font color="#0000ff">       private void </font>BindGridView<font color="#000080">()
</font><font color="#000080">       {
</font><font color="#008000">         //Create and populate the datatable that stores GridView data
</font>         DataTable dataTable <font color="#000080">=</font><font color="#0000ff">new </font>DataTable<font color="#000080">();
</font>         DataColumn <font color="#000080">[] </font>columns <font color="#000080">= { </font><font color="#0000ff">new </font>DataColumn<font color="#000080">(</font><font color="#800000">"ID"</font><font color="#000080">), </font><font color="#0000ff">new </font>DataColumn<font color="#000080">(</font><font color="#800000">"Data"</font><font color="#000080">) };
</font>         Object <font color="#000080">[] </font>row1<font color="#000080">= { </font><font color="#800000">"1"</font><font color="#000080">), </font><font color="#800000">"Data 1" </font><font color="#000080">};
</font>         Object <font color="#000080">[] </font>row2<font color="#000080">= { </font><font color="#800000">"2"</font><font color="#000080">), </font><font color="#800000">"Data 2" </font><font color="#000080">};
</font>         Object <font color="#000080">[] </font>row3<font color="#000080">= { </font><font color="#800000">"3"</font><font color="#000080">), </font><font color="#800000">"Data 3" </font><font color="#000080">};
</font>         dataTable<font color="#000080">.</font>Columns<font color="#000080">.</font>AddRange<font color="#000080">(</font>columns<font color="#000080">);
</font>         dataTable<font color="#000080">.</font>Rows<font color="#000080">.</font>Add<font color="#000080">(</font>row1<font color="#000080">);
</font>         dataTable<font color="#000080">.</font>Rows<font color="#000080">.</font>Add<font color="#000080">(</font>row2<font color="#000080">);
</font>         dataTable<font color="#000080">.</font>Rows<font color="#000080">.</font>Add<font color="#000080">(</font>row3<font color="#000080">);

</font><font color="#008000">         //Set the GridView data
</font>         gridView<font color="#000080">.</font>DataSource <font color="#000080"> = </font>dataTable<font color="#000080">; 
</font>         gridView<font color="#000080">.</font>DataBind<font color="#000080">(); 
</font><font color="#000080">       }
    }
}
</font>
</code></pre>
		     <table id="Table4" width="500">
			<tr>
				<td align="right" class="text"><a href="javascript:back();">Back</a></td>
				<td width="50">&nbsp;&nbsp;</td>
				<td align="left" class="text"><a href="../../html/programmerGuide/tutorials/html/csharp/UserDefinedCellsFormat/Tutorial2.htm">Next</a></td>
			</tr>
		</table>
		     <br/>
		  </td>
        </tr>
    </table>
    <div id="banner" class="banner" align="left">
      <table id="Table6" cellpadding="0" cellspacing="0">
        <tr>
          <td class="banner" align="left">&nbsp;&nbsp;&copy; EU Outsourcing, 2017. All Rights Reserved. </td>
        </tr>
      </table>
    </div>
    <div style="height: 5px">
    </div>
</body>
</html>
